# TetrisJs

## スクリプトの仕様 (`script.js`)

このスクリプトは、HTML5 Canvas を使用したテトリスゲームのロジックを実装しています。

### 主要な機能

- **ゲームの初期化 (`init`)**:
  - ゲームボード、スコア、ライン数、レベルをリセットします。
  - 最初のピースと次のピースを生成し、ゲームループを開始します。

- **ピースの生成と配置 (`createPiece`, `spawnNewPiece`)**:
  - ランダムなテトリミノ（ブロック）を生成します。
  - 生成されたピースをゲームボードの上部に配置します。
  - 初期位置で衝突が発生した場合、ゲームオーバーを判定します。

- **描画処理 (`draw`, `drawBoard`, `drawPiece`, `drawNextPiece`)**:
  - ゲームボード、現在のピース、次のピースを Canvas に描画します。

- **ゲームループ (`animate`)**:
  - ピースの自動落下を制御します。
  - 描画処理を繰り返し実行します。

- **ピースの操作**:
  - **`movePieceDown()`**: ピースを1マス下に移動させます。衝突する場合はピースを固定し、ライン消去と次のピース生成を行います。
  - **`movePieceLeft()`**: ピースを左に1マス移動させます。
  - **`movePieceRight()`**: ピースを右に1マス移動させます。
  - **`hardDrop()`**: ピースを一番下まで一気に落下させます。スコアボーナスが加算されます。
  - **`rotatePiece()`**: ピースを回転させます。壁キック処理も含まれます。

- **衝突判定 (`isValidMove`)**:
  - 指定された位置にピースを移動できるか（ボードの範囲内か、他のブロックと衝突しないか）を判定します。

- **ピースの固定 (`lockPiece`)**:
  - 現在のピースをゲームボードに固定します。

- **ライン消去とスコア計算 (`removeLines`)**:
  - 揃ったラインを検出し、削除します。
  - ライン数に応じてスコアとレベルを更新し、落下速度を調整します。

- **情報表示の更新 (`updateInfo`)**:
  - スコア、ライン数、レベルの表示を更新します。

- **ゲームオーバー処理 (`showGameOver`)**:
  - ゲームオーバー画面を表示し、ゲームループを停止します。

### イベントリスナー

- **キーボード操作**:
  - `ArrowLeft`, `KeyA`: 左移動
  - `ArrowRight`, `KeyD`: 右移動
  - `ArrowDown`, `KeyS`: ソフトドロップ（下に移動、スコアボーナス）
  - `ArrowUp`, `KeyW`: 回転
  - `Space`: ハードドロップ

- **モバイル用ボタン操作**:
  - `left-button`: 左移動
  - `right-button`: 右移動
  - `down-button`: ソフトドロップ
  - `rotate-button`: 回転
  - `drop-button`: ハードドロップ
  - `restart-button`: ゲームを再開
